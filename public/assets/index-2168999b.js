import{g as R,H as Q,az as V,J as $,aQ as q,k as x,r as b,a0 as n,L as F,F as c,Q as r,X as a,aA as N,G as e,R as w,N as M,O as B,P as E,Z as P,bC as H,E as u,S as l,am as U,_ as X,bE as _,aq as T,bO as Z}from"./index-2efe4620.js";import{_ as K}from"./titleBar.vue_vue_type_script_setup_true_lang-c8a01297.js";import{N as W,a as Y}from"./Tabs-d30e51ae.js";import"./Add-1eab33c9.js";const ee={class:"main min-h-screen bg-center dark:bg-[#2F2E34] h-full flex flex-col overflow-hidden"},ae={key:0,class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-x-6 gap-y-10 px-4"},te=["onClick"],se={class:"w-full rounded-t-xl overflow-hidden border dark:border-[#ffffff17] relative",style:{height:"40%"}},ne=["src"],le={class:"absolute left-1/2 bottom-0 transform -translate-x-1/2 -translate-y-1/2 text-lg text-[#fff] ]"},oe={class:"p-5 text-lg h-[160px] border-b dark:border-[#ffffff17] overflow-hidden relative"},re={class:"absolute bottom-1 right-2 font-semibold text-red-500 italic"},ie={class:"flex p-4 border-b dark:border-[#ffffff17] flex-col space-y-4"},de={class:"flex justify-between"},ce={class:"flex justify-between"},ue={class:"flex justify-between"},fe={class:"px-4 flex-1 flex items-center justify-between"},pe={class:"flex items-end"},ye={class:"ml-2 text-[#3076fd] text-lg"},ge=e("div",{class:"line"},null,-1),he={key:1,class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-x-6 gap-y-10 px-4"},xe={class:"w-full rounded-t-xl overflow-hidden",style:{height:"40%"}},_e={class:"p-5 text-lg h-[160px] border-b dark:border-[#ffffff17] overflow-ellipsis"},ve={class:"flex p-4 border-b dark:border-[#ffffff17] flex-col space-y-4"},me={class:"px-4 flex-1 flex items-center justify-between"},Ne=R({__name:"index",setup(be){const y=Q(),{isMobile:f}=V(),v=$(),g=q(),j=x(()=>{var o;const t=window.navigator.userAgent.toLowerCase();return t.match(/MicroMessenger/i)&&((o=t==null?void 0:t.match(/MicroMessenger/i))==null?void 0:o[0])==="micromessenger"}),i=x(()=>{const{payHupiStatus:t,payEpayStatus:o,payMpayStatus:s,payWechatStatus:d,payLtzfStatus:m}=y.globalConfig;return Number(d)===1?"wechat":Number(s)===1?"mpay":Number(t)===1?"hupi":Number(o)===1?"epay":Number(m)===1?"ltzf":null}),J=x(()=>{const{payEpayChannel:t,payMpayChannel:o}=y.globalConfig;return i.value==="wechat"?["wxpay"]:i.value==="epay"?t?JSON.parse(t):[]:i.value==="mpay"?o?JSON.parse(o):[]:i.value==="hupi"?["wxpay"]:i.value==="ltzf"?["wxpay"]:[]}),k=b([]),S=b(1),p=b(!1);async function C(){try{p.value=!0;const t=await H({status:1,type:S.value,size:30});k.value=t.data.rows,p.value=!1}catch{p.value=!1}}const I=x(()=>f.value?n("pay.welcomeTipMobile"):n("pay.welcomeTipDesktop"));function L(t){S.value=t,C()}async function O(t){J.value.length||v.warning(n("pay.paymentNotEnabled")),z(t)}async function z(t){if(j.value&&i.value==="wechat"&&Number(y.globalConfig.payWechatStatus)===1){if(typeof WeixinJSBridge>"u")document.addEventListener?document.addEventListener("WeixinJSBridgeReady",h,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",h),document.attachEvent("onWeixinJSBridgeReady",h));else{const o=await Z({goodsId:t.id,payType:"jsapi"}),{success:s,data:d}=o;s&&h(d)}return}g.updateOrderInfo({pkgInfo:t}),g.updateGoodsDialog(!1),g.updatePayDialog(!0)}function h(t){const{appId:o,timeStamp:s,nonceStr:d,package:m,signType:G,paySign:A}=t;o&&WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:o,timeStamp:s,nonceStr:d,package:m,signType:G,paySign:A},D=>{D.err_msg==="get_brand_wcpay_request:ok"?(v.success(n("pay.purchaseSuccess")),setTimeout(()=>{y.getUserInfo(),g.updateGoodsDialog(!1)},500)):v.warning(n("pay.paymentNotComplete"))})}return F(()=>{C()}),(t,o)=>(u(),c("div",ee,[r(a(K),{title:a(n)("pay.membershipMarket"),des:I.value,class:N([a(f)?"px-3":"px-24"])},null,8,["title","des","class"]),e("div",{class:"flex justify-center items-center",style:M({height:a(f)?"60px":"180px"})},[r(a(Y),{type:"segment",style:M({width:a(f)?"90%":"400px"}),"onUpdate:value":L},{default:w(()=>[r(a(W),{name:1,tab:a(n)("pay.memberPackage")},null,8,["tab"]),r(a(W),{name:-1,tab:a(n)("pay.permanentAddOnCard")},null,8,["tab"])]),_:1},8,["style"])],4),e("div",{class:N(["flex-1 pb-10 overflow-y-auto",[a(f)?"px-3":"px-28"]])},[p.value?P("",!0):(u(),c("div",ae,[(u(!0),c(B,null,E(k.value,s=>(u(),c("div",{key:s.id,class:"border dark:border-[#ffffff17] h-[580px] rounded-xl card-item flex flex-col",onClick:d=>O(s)},[e("div",se,[e("img",{src:s.coverImg,class:"object-cover w-full h-full cover",alt:""},null,8,ne),e("div",le,l(s.name),1)]),e("div",oe,[U(l(s.des)+" ",1),e("span",re,"ï¿¥"+l(s.price),1)]),e("div",ie,[e("div",de,[e("span",null,l(a(n)("pay.baseModelQuota")),1),e("span",null,l(s.model3Count||0)+" "+l(a(n)("pay.points")),1)]),e("div",ce,[e("span",null,l(a(n)("pay.advancedModelQuota")),1),e("span",null,l(s.model4Count||0)+" "+l(a(n)("pay.points")),1)]),e("div",ue,[e("span",null,l(a(n)("pay.MJDrawingQuota")),1),e("span",null,l(s.drawMjCount||0)+" "+l(a(n)("pay.points")),1)])]),e("div",fe,[e("div",pe,[e("span",null,l(a(n)("pay.packageValidity")),1),e("span",ye,l(s.days>0?`${s.days} ${a(n)("pay.days")}`:a(n)("pay.permanent")),1)]),ge,e("div",null,[r(a(X),{class:"text-lg right-icon",icon:"bi:arrow-right"})])])],8,te))),128))])),p.value?(u(),c("div",he,[(u(),c(B,null,E(4,s=>e("div",{key:s,class:"border dark:border-[#ffffff17] h-[580px] rounded-xl card-item flex flex-col"},[e("div",xe,[r(a(_),{height:"100%",width:"100%"})]),e("div",_e,[r(a(T),{vertical:""},{default:w(()=>[r(a(_),{text:"",repeat:4,width:"100%",sharp:!1})]),_:1})]),e("div",ve,[r(a(T),{vertical:""},{default:w(()=>[r(a(_),{text:"",repeat:4,width:"100%",sharp:!1})]),_:1})]),e("div",me,[r(a(_),{text:"",repeat:1,width:"100%",sharp:!1})])])),64))])):P("",!0)],2)]))}});export{Ne as default};
